## Welcome to Subletr Backend

NOTE: On Mac, port 5000 is used by default by AirPlay Receiver. You must turn that off to run the server, as there will be port conflicts if you dont

## To run the server:

### `cd subletr-reactapp/backend`

Navigate to the backend folder

### `npm install`

Install all the required packages for the backend

### `npm start`

This will start the server at http://localhost:5000

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

*   [passport][1]
    *   [Parameters][2]
*   [handleAuthentication][3]
    *   [Parameters][4]
*   [updateCustomer][5]
    *   [Parameters][6]
*   [chatCompletion][7]
    *   [Parameters][8]
*   [openaiController][9]
    *   [Parameters][10]
*   [getAllListings][11]
    *   [Parameters][12]
*   [createListing][13]
    *   [Parameters][14]
*   [acceptListing][15]
    *   [Parameters][16]
*   [getUserListings][17]
    *   [Parameters][18]
*   [getFavoritedListings][19]
    *   [Parameters][20]
*   [getRentalHistory][21]
    *   [Parameters][22]
*   [logListingFavorite][23]
    *   [Parameters][24]
*   [deleteListing][25]
    *   [Parameters][26]
*   [editListing][27]
    *   [Parameters][28]
*   [generateToken][29]
    *   [Parameters][30]
*   [verifyToken][31]
    *   [Parameters][32]
*   [createRentSubscription][33]
    *   [Parameters][34]
*   [createWebhook][35]
    *   [Parameters][36]
*   [sendAwsEmail][37]
    *   [Parameters][38]
*   [getConversations][39]
    *   [Parameters][40]
*   [getMessages][41]
    *   [Parameters][42]
*   [sendMessage][43]
    *   [Parameters][44]

## passport

Configuration for the Google authentication strategy.

### Parameters

*   `passport` **[Object][45]** The passport instance to use for authentication.

## handleAuthentication

Handles the authentication process for the customer.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.
*   `customer` **[Object][45]** The customer object.

Returns **[Object][45]** The response object.

## updateCustomer

Updates the customer information.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object for success verification

## chatCompletion

Generates completion chat responses using the OpenAI API.

### Parameters

*   `prompt` **[string][46]** The user prompt.

Returns **[Promise][47]<[Object][45]>** The completion response from the OpenAI API.

## openaiController

Controller function to access the OpenAI API for generating text completions.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object (will be a promise)

## getAllListings

Retrieves all listings.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object containing all the listing objects (ref Mongoose schema)

## createListing

Creates a new listing.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object for success verification.

## acceptListing

Accepts a listing request.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object for success verification.

## getUserListings

Retrieves the listings created by a specific user.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object containing a user's listings (ref Mongoose schema).

## getFavoritedListings

Retrieves the favorited listings for a particular user.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object containing a user's favorited listings (ref Mongoose schema).

## getRentalHistory

Retrieves the rental history for a particular user.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object.

## logListingFavorite

Logs a favorite action for a listing.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object for success verification.

## deleteListing

Deletes a listing.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object for success verification.

## editListing

Edits a listing.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object for success verification.

## generateToken

Generates a JWT token.

### Parameters

*   `options` **[Object][45]** The options for generating the token.

    *   `options.id` **[string][46]** The ID for the token.
    *   `options.errorMessage` **[string][46]** The error message to throw in case of an error.
    *   `options.secret` **[string][46]** The secret key to sign the token.

<!---->

*   Throws **[Error][48]** If an error occurs during token generation.

Returns **[string][46]** The generated token.

## verifyToken

Verifies a JWT token.

### Parameters

*   `options` **[Object][45]** The options for verifying the token.

    *   `options.token` **[string][46]** The token to verify.
    *   `options.errorMessage` **[string][46]** The error message to throw in case of an error.
    *   `options.secret` **[string][46]** The secret key to verify the token.

Returns **[string][46]** The ID extracted from the token.

## createRentSubscription

Creates a rent subscription in Stripe.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object.

## createWebhook

Creates a webhook endpoint to process Stripe events.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object.

## sendAwsEmail

Sends an email using AWS SES.

### Parameters

*   `from` **[string][46]** The email address of the sender.
*   `to` **[string][46]** The email address of the recipient.
*   `subject` **[string][46]** The subject of the email.
*   `content` **[string][46]** The content of the email.

Returns **[Promise][47]<[Object][45]>** A promise that resolves to the response object.

## getConversations

Retrieves all conversations for a particular user.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object.

## getMessages

Retrieves all messages for a particular conversation.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object.

## sendMessage

Sends a message for a particular conversation.

### Parameters

*   `req` **[Object][45]** The request object.
*   `res` **[Object][45]** The response object.

Returns **[Object][45]** The response object.

[1]: #passport

[2]: #parameters

[3]: #handleauthentication

[4]: #parameters-1

[5]: #updatecustomer

[6]: #parameters-2

[7]: #chatcompletion

[8]: #parameters-3

[9]: #openaicontroller

[10]: #parameters-4

[11]: #getalllistings

[12]: #parameters-5

[13]: #createlisting

[14]: #parameters-6

[15]: #acceptlisting

[16]: #parameters-7

[17]: #getuserlistings

[18]: #parameters-8

[19]: #getfavoritedlistings

[20]: #parameters-9

[21]: #getrentalhistory

[22]: #parameters-10

[23]: #loglistingfavorite

[24]: #parameters-11

[25]: #deletelisting

[26]: #parameters-12

[27]: #editlisting

[28]: #parameters-13

[29]: #generatetoken

[30]: #parameters-14

[31]: #verifytoken

[32]: #parameters-15

[33]: #createrentsubscription

[34]: #parameters-16

[35]: #createwebhook

[36]: #parameters-17

[37]: #sendawsemail

[38]: #parameters-18

[39]: #getconversations

[40]: #parameters-19

[41]: #getmessages

[42]: #parameters-20

[43]: #sendmessage

[44]: #parameters-21

[45]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[46]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[47]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[48]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error
